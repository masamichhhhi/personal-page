---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import BlogCard from '@components/BlogCard.astro';
import Pagination from '@components/Pagination.astro';

const POSTS_PER_PAGE = 10;
const currentPage = 1;

const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const sortedPosts = allPosts.sort(
  (a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf()
);

const totalPages = Math.ceil(sortedPosts.length / POSTS_PER_PAGE);
const posts = sortedPosts.slice(0, POSTS_PER_PAGE);
---

<BaseLayout title="Blog | Personal Page" description="Read my thoughts on technology, development, and more.">
  <div class="container py-12">
    <header class="mb-12">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">Blog</h1>
      <p class="text-lg text-gray-600">
        Thoughts, tutorials, and insights on technology and development.
      </p>
    </header>

    {posts.length > 0 ? (
      <div class="space-y-8">
        {posts.map((post) => (
          <BlogCard
            title={post.data.title}
            slug={post.slug}
            publishedAt={post.data.publishedAt}
            summary={post.data.summary}
            tags={post.data.tags}
          />
        ))}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-gray-600 text-lg">No articles yet.</p>
        <p class="text-gray-500 mt-2">Check back soon for new content!</p>
      </div>
    )}

    <Pagination currentPage={currentPage} totalPages={totalPages} baseUrl="/blog" />
  </div>
</BaseLayout>
